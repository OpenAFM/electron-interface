<dom-module id="afm-plot">

  <style>
    .background {
      fill: #fff;
    }

    line {
      stroke: #fff;
    }

    text.active {
      fill: red;
    }

  </style>


  <link href="../styles/bootstrap.min.css" rel="stylesheet">
  <link href="../styles/draw.css" rel="stylesheet">

  <template>
    <!--h2 class="paper-font-display2" style="text-align:center">Live AFM Scan Preview</h2-->
      <div class="container">

            <!--左边 normal 图像-->
            <div class="col-md-6" id="leftImage"></div>

             <!--左边 retrace 图像-->
            <div class="col-md-6" id="rightImage"></div>

             <!--左边 当前输入信号-->
            <div class="col-md-6">
                <div id="leftChart" style="margin:0 auto; width:420px"></div>
            </div>

             <!--右边 当前输入信号-->
            <div class="col-md-6">
                <div id="rightChart" style="margin:0 auto; width:420px"></div>
            </div>

      </div>
  
  </template>

  <!--script src="js/bootstrap.min.js"></script-->
  <script src="../js/d3.js"></script>

  <script src="../js/common.js"></script>
  
  <!-- 绘出 Image & Retrace Image Signal Current-->
  <script src="../js/drawSignal.js"></script>

  <!-- 绘出 Image & Retrace Image -->
  <script src="../js/drawMatrix.js"></script>

  <!-- main control script -->
  <script>
    var n = 256;
    function initialisePlot(n, cb) {
      console.log('Initialising Plot');
      initAll(n, function() {
        cb();
      });
    }
    var log = function() {
      console.log('Plot ready for data');
    }
    console.log('running afm-plot script');
    setTimeout('initialisePlot(n, log)', 1000);

    var arduino = require('./js/arduino.js');
    var lineEmitter = arduino.lineEmitter;
    lineEmitter.on('line', function(line) {
      console.log('Plot received data: ' + line + ' Plotting now');
      drawARow(line, function() {
        console.log('Data plotted, emittng confirmation.')
          lineEmitter.emit('plotted');
      });
    });

    (function() {
      Polymer({
        is: 'afm-plot',
        properties: { },

        ready: function() {
        }
      });
    })();
  </script>

</dom-module>

